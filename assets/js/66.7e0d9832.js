(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{761:function(s,a,t){"use strict";t.r(a);var e=t(3),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"pm2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pm2"}},[s._v("#")]),s._v(" pm2")]),s._v(" "),a("p",[s._v("pm2 主要为 linux 中 nodejs 的进程进行服务，接下来就统计一下它的指令都有哪些")]),s._v(" "),a("h3",{attrs:{id:"升级-pm2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#升级-pm2"}},[s._v("#")]),s._v(" 升级 PM2")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pm2@latest "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v("\n$ pm2 update\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ cnpm "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pm2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("软链接（不然找不到pm2）")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("find / -nmae pm2\nln -s /usr/local/bin/pm2 /usr/bin/pm2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ pm2 start app.js "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动，守护进程和自动重启应用程序（node）")]),s._v("\n$ pm2 start app.py "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动，守护程序和自动重启应用程序（python）")]),s._v("\n$ pm2 start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--start")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动，守护程序和自动重启节点应用程序")]),s._v("\n$ pm2 start bin/www "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--watch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 koa 项目")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"停止"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#停止"}},[s._v("#")]),s._v(" 停止")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ pm2 stop all "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止所有应用程序")]),s._v("\n$ pm2 stop "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止进程 id 为 0 的应用程序")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"删除进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除进程"}},[s._v("#")]),s._v(" 删除进程")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ pm2 delete all "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 杀死并删除所有应用程序")]),s._v("\n$ pm2 delete "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除进程 id 为 0 的应用程序")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"重启所有应用程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启所有应用程序"}},[s._v("#")]),s._v(" 重启所有应用程序")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("pm2 restart all\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"集群模式-仅限-nodejs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群模式-仅限-nodejs"}},[s._v("#")]),s._v(" 集群模式（仅限 Nodejs）")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ pm2 start app.js "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在集群模式下启动 4 个应用程序 # 它将负载平衡每个应用程序的网络查询")]),s._v("\n$ pm2 reload all "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 零秒停机重启")]),s._v("\n$ pm2 scale "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("app-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 规模集群应用到 10 个进程")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"进程监控"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进程监控"}},[s._v("#")]),s._v(" 进程监控")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ pm2 list "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出 pm2 的所有流程")]),s._v("\n$ pm2 monit "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示每个应用程序的内存和 cpu 使用情况")]),s._v("\n$ pm2 show "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("app-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示相关应用程序的所有信息")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-11-centos prod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pm2 list")]),s._v("\n┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐\n│ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │\n├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤\n│ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" │ abstract-egg       │ fork     │ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    │ online    │ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%       │ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v(".0mb   │\n│ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" │ abstract-express   │ fork     │ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("   │ errored   │ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%       │ 0b       │\n│ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" │ antdpro-express    │ fork     │ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    │ online    │ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%       │ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("54")]),s._v(".5mb   │\n└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"日志管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#日志管理"}},[s._v("#")]),s._v(" 日志管理")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ pm2 logs "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示所有应用程序的日志")]),s._v("\n$ pm2 logs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("app-name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示特定应用程序的日志")]),s._v("\n$ pm2 logs "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--json")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志 json 格式化")]),s._v("\n$ pm2 flush\n$ pm2 reloadLogs\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"进程状态管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进程状态管理"}},[s._v("#")]),s._v(" 进程状态管理")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ pm2 start app.js "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"api"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动应用程序，并将其命名为 “api”")]),s._v("\n$ pm2 start app.js "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--watch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新启动文件，更改应用程序")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);