---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的vuepress学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# pm2

::: tip 前言
pm2 主要为 linux 中 nodejs 的进程进行服务，接下来就统计一下它的指令都有哪些
:::

### 升级 PM2

```sh
npm install pm2@latest -g
pm2 update
```

### 安装

```sh
cnpm install pm2 -g
```

- 软链接（不然找不到pm2）

```
find / -nmae pm2
ln -s /usr/local/bin/pm2 /usr/bin/pm2
```

### 启动

```sh
pm2 start app.js # 启动，守护进程和自动重启应用程序（node）
pm2 start app.py # 启动，守护程序和自动重启应用程序（python）
pm2 start npm --start # 启动，守护程序和自动重启节点应用程序
pm2 start bin/www --watch # 启动 koa 项目
```

### 停止

```sh
pm2 stop all # 停止所有应用程序
pm2 stop 0 # 停止进程 id 为 0 的应用程序
```

### 删除进程

```sh
pm2 delete all # 杀死并删除所有应用程序
pm2 delete 0 # 删除进程 id 为 0 的应用程序
```

### 重启所有应用程序

```sh
pm2 restart all
```

### 集群模式（仅限 Nodejs）

```sh
pm2 start app.js -i 4 # 在集群模式下启动 4 个应用程序 # 它将负载平衡每个应用程序的网络查询
pm2 reload all # 零秒停机重启
pm2 scale [app-name] 10 # 规模集群应用到 10 个进程
```

### 进程监控

- 列出 pm2 的所有流程

```sh
pm2 list 
```

::: demo

```vue
<template>
  <div>
    <web-button type="success" @click="run('pm2 list')">查询</web-button>
    <pre style="background: wheat;"> {{res}}</pre>
  </div>
</template>
<script>
export default {
  data() {
    return {
      res:''
    }
  },
  methods: {
    async run(task) {
      this.res  = await this.$api?.example.query(task)
    },
  },
}
</script>
```

:::

- 显示每个应用程序的内存和 cpu 使用情况

```sh
pm2 monit 
```

::: demo

```vue
<template>
  <div>
    <web-button type="success" @click="run('pm2 monit')">查询</web-button>
    <pre style="background: wheat;"> {{res}}</pre>
  </div>
</template>
<script>
export default {
  data() {
    return {
      res:''
    }
  },
  methods: {
    async run(task) {
      this.res  = await this.$api?.example.query(task)
    },
  },
}
</script>
```

:::

- 显示相关应用程序的所有信息

```sh
pm2 show [app-name] 
```

::: demo

```vue
<template>
  <div>
    <web-button type="success" @click="run('pm2 show antdpro-express')">查询</web-button>
    <pre style="background: wheat;"> {{res}}</pre>
  </div>
</template>
<script>
export default {
  data() {
    return {
      res:''
    }
  },
  methods: {
    async run(task) {
      this.res  = await this.$api?.example.query(task)
    },
  },
}
</script>
```

:::

### 日志管理

- 显示所有应用程序的日志

```sh
pm2 logs [app-name]
```

::: demo

```vue
<template>
  <div>
    <web-button type="success" @click="run('pm2 logs antdpro-express')">查询</web-button>
    <pre style="background: wheat;"> {{res}}</pre>
  </div>
</template>
<script>
export default {
  data() {
    return {
      res:''
    }
  },
  methods: {
    async run(task) {
      this.res  = await this.$api?.example.query(task)
    },
  },
}
</script>
```

:::

- 日志 json 格式化

```sh
pm2 logs --json
```

::: demo

```vue
<template>
  <div>
    <web-button type="success" @click="run('pm2 logs --json')">查询</web-button>
    <pre style="background: wheat;"> {{res}}</pre>
  </div>
</template>
<script>
export default {
  data() {
    return {
      res:''
    }
  },
  methods: {
    async run(task) {
      this.res  = await this.$api?.example.query(task)
    },
  },
}
</script>
```


-

```sh
pm2 flush
```

::: demo

```vue
<template>
  <div>
    <web-button type="success" @click="run('pm2 flush')">查询</web-button>
    <pre style="background: wheat;"> {{res}}</pre>
  </div>
</template>
<script>
export default {
  data() {
    return {
      res:''
    }
  },
  methods: {
    async run(task) {
      this.res  = await this.$api?.example.query(task)
    },
  },
}
</script>
```

:::

- 

```sh
pm2 reloadLogs
```

::: demo

```vue
<template>
  <div>
    <web-button type="success" @click="run('pm2 reloadLogs')">查询</web-button>
    <pre style="background: wheat;"> {{res}}</pre>
  </div>
</template>
<script>
export default {
  data() {
    return {
      res:''
    }
  },
  methods: {
    async run(task) {
      this.res  = await this.$api?.example.query(task)
    },
  },
}
</script>
```

:::

### 进程状态管理

```sh
pm2 start app.js --name="api" # 启动应用程序，并将其命名为 “api”
pm2 start app.js --watch # 重新启动文件，更改应用程序
```
